<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutorial 4 - Updating your application &mdash; BeeWare 0.3.0 文档</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/tabs.js"></script>
        <script src="../_static/translations.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="Tutorial 5 - Taking it Mobile" href="tutorial-5/index.html" />
    <link rel="prev" title="Tutorial 3 - Packaging for distribution" href="tutorial-3.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> BeeWare
            <img src="../_static/beeware.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tutorial-0.html">教程 0 - 开始行动！</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial-1.html">教程1 —— 第一个应用</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial-2.html">Tutorial 2 - Making it interesting</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial-3.html">Tutorial 3 - Packaging for distribution</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial 4 - Updating your application</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#updating-application-code">Updating application code</a></li>
<li class="toctree-l2"><a class="reference internal" href="#update-and-run-in-one-step">Update and run in one step</a></li>
<li class="toctree-l2"><a class="reference internal" href="#next-steps">Next steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorial-5/index.html">Tutorial 5 - Taking it Mobile</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial-6.html">Tutorial 6 - Get this (third)-party started</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial-7.html">Tutorial 7 - Making it Smooooth</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial-8.html">Tutorial 8 - Make this app your own</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial-9.html">Tutorial 9 - Put it on the web!</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial-10.html">Tutorial 10 - Publishing your app!</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BeeWare</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Tutorial 4 - Updating your application</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorial/tutorial-4.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="tutorial-4-updating-your-application">
<h1>Tutorial 4 - Updating your application<a class="headerlink" href="#tutorial-4-updating-your-application" title="永久链接至标题">¶</a></h1>
<p>In the last tutorial, we packaged our application as a native application. If
you’re dealing with a real-world app, that isn’t going to be the end of the
story - you’ll likely do some testing, discover problems, and need to make some
changes. Even if your application is perfect, you’ll eventually want to publish
version 2 of your application with improvements.</p>
<p>So - how do you update your installed app when you make code changes?</p>
<div class="section" id="updating-application-code">
<h2>Updating application code<a class="headerlink" href="#updating-application-code" title="永久链接至标题">¶</a></h2>
<p>Our application currently prints to the console when you press the button.
However, GUI applications shouldn’t really use the console for output. They
need to use dialogs to communicate with users.</p>
<p>Let’s add a dialog box to say hello, instead of writing to the console.
Modify the <cite>say_hello</cite> callback so it looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">say_hello</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">main_window</span><span class="o">.</span><span class="n">info_dialog</span><span class="p">(</span>
        <span class="s1">&#39;Hello, </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name_input</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
        <span class="s1">&#39;Hi there!&#39;</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>This directs Toga to open a modal dialog box when the button is pressed.</p>
<p>If you run <code class="docutils literal notranslate"><span class="pre">briefcase</span> <span class="pre">dev</span></code>, enter a name, and press the button, you’ll see the
new dialog box:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-bWFjT1M=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-0-bWFjT1M=" name="bWFjT1M=" role="tab" tabindex="0">macOS</button><button aria-controls="panel-0-TGludXg=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-TGludXg=" name="TGludXg=" role="tab" tabindex="-1">Linux</button><button aria-controls="panel-0-V2luZG93cw==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="-1">Windows</button></div><div aria-labelledby="tab-0-bWFjT1M=" class="sphinx-tabs-panel group-tab" id="panel-0-bWFjT1M=" name="bWFjT1M=" role="tabpanel" tabindex="0"><img alt="Hello World Tutorial 4 dialog, on macOS" src="../_images/tutorial-4.png" />
</div><div aria-labelledby="tab-0-TGludXg=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-TGludXg=" name="TGludXg=" role="tabpanel" tabindex="0"><img alt="Hello World Tutorial 4 dialog, on Linux" src="../_images/tutorial-41.png" />
</div><div aria-labelledby="tab-0-V2luZG93cw==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0"><img alt="Hello World Tutorial 4 dialog, on Windows" src="../_images/tutorial-42.png" />
</div></div>
<p>However, if you run <code class="docutils literal notranslate"><span class="pre">briefcase</span> <span class="pre">run</span></code>, the dialog box won’t appear.</p>
<p>Why is this? Well, <code class="docutils literal notranslate"><span class="pre">briefcase</span> <span class="pre">dev</span></code> operates by running your code in place -
it tries to produce as realistic runtime environment for your code as possible,
but it doesn’t provide or use any of the platform infrastructure for wrapping
your code as an application. Part of the process of packaging your app involves
copying your code <em>into</em> the application bundle - and at the moment, your
application still has the old code in it.</p>
<p>So - we need to tell briefcase to copy over the new version of the code. We
<em>could</em> do this by deleting the old platform directory and starting from
scratch. However, Briefcase provides an easier way - you can update the code
for your existing bundled application:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-bWFjT1M=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-1-bWFjT1M=" name="bWFjT1M=" role="tab" tabindex="0">macOS</button><button aria-controls="panel-1-TGludXg=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-TGludXg=" name="TGludXg=" role="tab" tabindex="-1">Linux</button><button aria-controls="panel-1-V2luZG93cw==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="-1">Windows</button></div><div aria-labelledby="tab-1-bWFjT1M=" class="sphinx-tabs-panel group-tab" id="panel-1-bWFjT1M=" name="bWFjT1M=" role="tabpanel" tabindex="0"><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">(</span>beeware-venv<span class="o">)</span> $ briefcase update

<span class="o">[</span>helloworld<span class="o">]</span> Updating application code...
Installing src/helloworld...

<span class="o">[</span>helloworld<span class="o">]</span> Application updated.
</pre></div>
</div>
</div><div aria-labelledby="tab-1-TGludXg=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-TGludXg=" name="TGludXg=" role="tabpanel" tabindex="0"><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">(</span>beeware-venv<span class="o">)</span> $ briefcase update

<span class="o">[</span>helloworld<span class="o">]</span> Updating application code...
Installing src/helloworld...

<span class="o">[</span>helloworld<span class="o">]</span> Application updated.
</pre></div>
</div>
</div><div aria-labelledby="tab-1-V2luZG93cw==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0"><div class="highlight-doscon notranslate"><div class="highlight"><pre><span></span><span class="gp gp-VirtualEnv">(beeware-venv)</span> <span class="gp">C:\...&gt;</span>briefcase update

<span class="go">[helloworld] Updating application code...</span>
<span class="go">Installing src/helloworld...</span>

<span class="go">[helloworld] Application updated.</span>
</pre></div>
</div>
</div></div>
<p>If Briefcase can’t find the scaffolded template, it will automatically invoke
<cite>create</cite> to generate a fresh scaffold.</p>
<p>Now that we’ve updated the installer code, we can then run <code class="docutils literal notranslate"><span class="pre">briefcase</span> <span class="pre">build</span></code>
to re-compiled app, <code class="docutils literal notranslate"><span class="pre">briefcase</span> <span class="pre">run</span></code> to run the updated app, and <code class="docutils literal notranslate"><span class="pre">briefcase</span>
<span class="pre">package</span></code> to repackage the application for distribution.</p>
<p>(macOS users, remember that as noted in <a class="reference internal" href="tutorial-3.html"><span class="doc">Tutorial 3</span></a>, for the
tutorial we recommend running <code class="docutils literal notranslate"><span class="pre">briefcase</span> <span class="pre">package</span></code> with the <code class="docutils literal notranslate"><span class="pre">--no-sign</span></code> flag
to avoid the complexity of setting up a code signing identity and keep the
tutorial as simple as possible.)</p>
</div>
<div class="section" id="update-and-run-in-one-step">
<h2>Update and run in one step<a class="headerlink" href="#update-and-run-in-one-step" title="永久链接至标题">¶</a></h2>
<p>If you’re rapidly iterating code changes, you’ll likely want to make a code
change, update the application, and immediately re-run your application.
Briefcase has a shortcut to support this usage pattern - the <code class="docutils literal notranslate"><span class="pre">-u</span></code> (or
<code class="docutils literal notranslate"><span class="pre">--update</span></code>) option on the <code class="docutils literal notranslate"><span class="pre">run</span></code> command.</p>
<p>Let’s try making another change. You may have noticed that if you don’t type
a name in the text input box, the dialog will say “Hello, “. Let’s modify the
<code class="docutils literal notranslate"><span class="pre">say_hello</span></code> function again to handle this edge case:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">say_hello</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_input</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_input</span><span class="o">.</span><span class="n">value</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;stranger&#39;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">main_window</span><span class="o">.</span><span class="n">info_dialog</span><span class="p">(</span>
        <span class="s1">&#39;Hello, </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
        <span class="s1">&#39;Hi there!&#39;</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>Run your app in development mode (with <code class="docutils literal notranslate"><span class="pre">briefcase</span> <span class="pre">dev</span></code>) to confirm that the
new logic works; then update, build and run the app with one command:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-bWFjT1M=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-2-bWFjT1M=" name="bWFjT1M=" role="tab" tabindex="0">macOS</button><button aria-controls="panel-2-TGludXg=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-TGludXg=" name="TGludXg=" role="tab" tabindex="-1">Linux</button><button aria-controls="panel-2-V2luZG93cw==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="-1">Windows</button></div><div aria-labelledby="tab-2-bWFjT1M=" class="sphinx-tabs-panel group-tab" id="panel-2-bWFjT1M=" name="bWFjT1M=" role="tabpanel" tabindex="0"><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">(</span>beeware-venv<span class="o">)</span> $ briefcase run -u

<span class="o">[</span>helloworld<span class="o">]</span> Updating application code...
Installing src/helloworld...

<span class="o">[</span>helloworld<span class="o">]</span> Application updated.

<span class="o">[</span>helloworld<span class="o">]</span> Starting app...
</pre></div>
</div>
</div><div aria-labelledby="tab-2-TGludXg=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-2-TGludXg=" name="TGludXg=" role="tabpanel" tabindex="0"><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">(</span>beeware-venv<span class="o">)</span> $ briefcase run -u

<span class="o">[</span>helloworld<span class="o">]</span> Updating application code...
Installing src/helloworld...

<span class="o">[</span>helloworld<span class="o">]</span> Application updated.

<span class="o">[</span>helloworld<span class="o">]</span> Building AppImage...
...
<span class="o">[</span>helloworld<span class="o">]</span> Created linux/Hello World-x86_64-0.0.1.AppImage.

<span class="o">[</span>helloworld<span class="o">]</span> Starting app...
</pre></div>
</div>
</div><div aria-labelledby="tab-2-V2luZG93cw==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-2-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0"><div class="highlight-doscon notranslate"><div class="highlight"><pre><span></span><span class="gp gp-VirtualEnv">(beeware-venv)</span> <span class="gp">C:\...&gt;</span>briefcase run -u

<span class="go">[helloworld] Updating application code...</span>
<span class="go">Installing src/helloworld...</span>

<span class="go">[helloworld] Application updated.</span>

<span class="go">[helloworld] Starting app...</span>
</pre></div>
</div>
</div></div>
<p>This should only be required if you’re testing something about how your
application runs as a native binary, or hunting a bug that only manifests when
your application is in packaged form. For most day-to-day development,
<code class="docutils literal notranslate"><span class="pre">briefcase</span> <span class="pre">dev</span></code> will be a lot faster.</p>
<p>The package command also accepts the <code class="docutils literal notranslate"><span class="pre">-u</span></code> argument, so if you make a change
to your application code and want to repackage immediately, you can run
<code class="docutils literal notranslate"><span class="pre">briefcase</span> <span class="pre">package</span> <span class="pre">-u</span></code>.</p>
</div>
<div class="section" id="next-steps">
<h2>Next steps<a class="headerlink" href="#next-steps" title="永久链接至标题">¶</a></h2>
<p>We now have our application packaged for distribution on desktop platforms,
and we’ve been able to update the code in our application.</p>
<p>But what about mobile? In <a class="reference internal" href="tutorial-5/index.html"><span class="doc">Tutorial 5</span></a>, we’ll convert
our application into a mobile application, and deploy it onto a device
simulator, and onto a phone.</p>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tutorial-3.html" class="btn btn-neutral float-left" title="Tutorial 3 - Packaging for distribution" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tutorial-5/index.html" class="btn btn-neutral float-right" title="Tutorial 5 - Taking it Mobile" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2013, Russell Keith-Magee.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>